<% content_for :head do %>
  <%= stylesheet_link_tag "section/checkout" %>
<% end %>

<section id="payment" class="checkout">

  <%= render :partial => "shared/errors", :locals => { :object => @checkout } %>
  <%= form_for(@checkout, url: { action: "create" }) do |checkout_form| %>
    <div class="box-step-one">
      <h2 class="step-title">
        <span class="number">1.</span>
        <span class="title">Entrega</span>
        <span class="phrase">Como devemos enviar sua compra?</span>
      </h2>
    
      <div id="checkout_address">
      <% if @addresses.nil? || @addresses.empty? %>
        <%= render "shipping_address_form", address: @checkout.address %>
      <% else %>
        <%= render "address_list", addresses: @addresses, selected_address: @checkout.address %>
      <% end %>
      </div>
    </div>  

    <div class="box-step-two">
      <h2 class="step-title">
        <span class="number">2.</span>
        <span class="title">PAGAMENTO</span>
        <span class="phrase">Como devemos enviar sua compra?</span>
      </h2>

      <%= render "payments_type", checkout_form: checkout_form %>
    </div>
      
    <div class="box-step-three">  
      <%= checkout_form.submit '', class: "send_it" %>
    </div>
      
  <% end %>


  <% 
    
    address = @checkout.address
    address ||= @addresses.first if @addresses
  %>

  <%= render "cart_details", address: address %>

</section>

<% content_for :footer do %>
  <%= javascript_include_tag "checkout" %>
<% end %>