<%
shoe_size = params[:shoe_sizes].try(:first).try(:to_i) || current_user.try(:shoes_size).try(:to_i)
%>
<li class="product <%= " promotion" if product.promotion? %>" data-id="<%= product.id %>">
  <%= render "shared/product_hover", :product => product %>
  <div class="box_product <%= quantity_status_moments(product, shoe_size) %>">
    <%= link_to product, :class => "product_link", :rel => "#{product.id}", :remote => defined?(suggestion) do %>

      <%= image_tag("common/ajax-loader.gif", :alt => product.name, :class => "async", "data-product" => product.showroom_picture, "data-backside" => product.backside_picture, "data-wearing" => product.wearing_picture) %>
      <p><span class="model"><%= product.model_name %></span> <span class="name"><%= product.name %></span></p>
      <p class="brand">Olook</p>

      <p class="price">
      <% if product.promotion? %>
        <span class="old">De <%= number_to_currency product.price %></span>
        <span class="txt-pink">por <%= number_to_currency product.retail_price %></span>
      <% else %>
        <%= number_to_currency product.price %> ou <span class="plots"><%= installments(product.price) %></span>
      <% end %>
      </p>

      <p class="warn sold_out"><b>ESGOTADO!</b></p>

      <% if shoe_size && product.shoe? -%>
        <p class="warn shoe_size">Tam. <%= "#{shoe_size unless shoe_size.nil?}" %></p>
      <% end -%>

      <% if current_user && current_user.full_user? && product.promotion? == false -%>
        <p class="warn quantity">SÃ³ mais <span><%= "#{product.quantity(shoe_size) unless shoe_size.nil?}" %></span></p>
        <% if product.shoe? %>
          <p class="warn shoe_size">Tam. <%= shoe_size %></p>
        <% end %>
      <% end -%>

      <% if product.promotion? && !product.sold_out? && product.discount_percent.to_i != 0 %>
        <p class="warn percentage"><span><%= product.discount_percent.to_i %>%</span><br />off</p>
      <% end %>
    <% end %>    
  </div>
</li>
