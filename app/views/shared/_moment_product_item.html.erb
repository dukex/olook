<%
  shoe_size = params[:shoe_sizes].to_a.find { |ss| !ss.blank? }.try(:to_i) || current_user.try(:shoes_size).try(:to_i)
%>
<li class="product<%= " promotion" if product.promotion? %>" data-id="<%= product.id %>">
  <%= render "shared/product_hover", :product => product %>
  <div class="box_product <%= quantity_status_moments(product, shoe_size) %>">
    <%= link_to(product, :class => "product_link", :rel => "#{product.id}", :remote => defined?(suggestion)) do %>
      <%= image_tag("common/ajax-loader-product.gif", :alt => product.name, :class => "async", data: { product: product.catalog_picture, backside: product.backside_picture, wearing: product.wearing_picture } ) %>
      <p><span class="name"><%= product.formatted_name %></span></p>
      <p class="brand"><b><%= product.brand %></b></p>

      <p class="price">
        <% if product.promotion? %>
          <span class="old">De <%= number_to_currency product.price %></span>
          <span class="txt-black">por <%= number_to_currency product.retail_price %></span>
        <% else %>
          <%= number_to_currency product.price %> ou <span class="plots"><%= installments(product.price) %></span>
        <% end %>
      </p>

      <p class="warn sold_out"><b>ESGOTADO!</b></p>

      <% if product.promotion? && !product.sold_out? && product.discount_percent.to_i != 0 %>
        <p class="warn percentage"><span><%= product.discount_percent.to_i %>%</span><br />off</p>
      <% end %>
    <% end %>
  </div>
</li>
