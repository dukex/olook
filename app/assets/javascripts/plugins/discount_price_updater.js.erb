function DiscountPriceUpdater(opts) {
  this.product_ids = opts['product_ids'];
  this.prices = {};
}

DiscountPriceUpdater.prototype.getPrices = function() {
  $.ajax({
    url: '<%= Rails.application.routes.url_helpers.api_prices_path(format: 'json') %>',
    data: { product_ids: this.product_ids }
  }).success(function(data){
    this.prices = data['prices'];
  });
}

DiscountPriceUpdater.prototype.replaceUpdatedPrices = function() {
  for( var product_id in this.prices ) {
    var li = $('li[data-id="' + product_id + '"]');
    li.find('.price').remove();
    var html = '<%= render('shared/searched_product_discount_price', from: '__OLD__', to: '__NEW__') %>';
    var values = this.prices[product_id];
    li.find('.info-product').append(html.replace(/__OLD__/g, values['de']).replace(/__NEW__/g, values['por']));
  }
}
