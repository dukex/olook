$(document).ready(function() {
  $("#my_account ul.shoes_size li label, .clone ul.shoes_size li label").live("click", function() {
    $(this).parents("ul.shoes_size").find("li").removeClass("selected");
    $(this).parent().addClass("selected");
  });

  $("div#my_account.my_gifts table tbody tr td.edit a").on("click", function(e) {
    var clone = $('.dialog.gifted').clone().addClass('clone');
    var content = clone[0].outerHTML;
    initBase.newModal(content);
    e.preventDefault();
  });

  $('.zip_code').change(function(){
    var cep = $(this).val().replace(/\D/, '');
    if(cep.length >= 8) {
      var url = '<%= Rails.application.routes.url_helpers.cep_path('__CEP__') %>';
      url = url.replace('__CEP__', cep);
      $.getJSON(url, function(data){
        $('#address_street').val(data.endereco);
        $('#address_neighborhood').val(data.bairro);
        // TODO: Usar a biblioteca de cidade e estado fode a porra toda
        $('#address_state').val(data.estado);
        setTimeout(function(){
          $('#address_city').val(data.cidade);
        }, 1000);
      });
    }
  });
});
